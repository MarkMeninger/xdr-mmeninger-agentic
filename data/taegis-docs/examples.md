### Examples

Query for all generic events from Zeek in the last 2 hours

    from generic where sensor_type = 'zeek' earliest = -2h

Query for all generic events within the last 2 hours with the substring &#8217;secureworks&#8217;

    from generic where original_data contains 'secureworks' earliest = -2h

or, using the logical type `@raw` as an alias for `original_data`:

    from generic where @raw contains 'secureworks' earliest = -2h

Query for all detections that have a severity of high or critical:

    from detection where severity >= 0.6

Query for all detections that have a severity of low:

    from detection where severity >= 0.2 and severity < 0.4

Query for all detections where &#8217;Powershell&#8217; appears in the detection title:

    from detection where title contains 'Powershell'

Query for all detections where &#8217;mimikatz&#8217; appears in the commandline event fields:

    from detection where @command contains 'mimikatz'

Query for all detections where  the username &#8217;admin&#8217; is the user associated with the event that generated the detection:

    from detection where @user contains 'admin'

Query for all detections that have the detector name of &#8217;Taegis Watchlist&#8217;:

    from detection where metadata.creator.detector.detector_name = 'Taegis Watchlist'

Query for all detections generated by the detector ID &#8217;event-filter&#8217;:

    from detection where metadata.creator.detector.detector_id contains 'event-filter'

Query for detections where the process parent image path contains &#8217;cmd.exe&#8217;:

    from detection where process.parent_image_path contains 'cmd.exe'

Query across all event types that have an IP address field for the IP &#8217;10.0.0.1&#8217;:

    @ip='10.0.0.1'

Query across all event types that have a domain name field for the name &#8217;redcloak.secureworks.com&#8217;:

    @domain='redcloak.secureworks.com'

Query only netflow events for the IP address &#8217;10.0.0.1&#8217;:

    from netflow @ip='10.0.0.1'

Query netflow and auth event types for the IP &#8217;10.0.0.1&#8217;:

    from netflow, auth @ip='10.0.0.1'

Query only netflow events for IP addresses in the range &#8217;192.168.2.0/24&#8217;:

    from netflow where @ip='192.168.2.0/24'

Query netflow and auth event types for IP addresses in the range &#8217;192.168.2.0/24&#8217;:

    from netflow, auth where @ip matches '192.168.2.0/24'

Query only netflow events for IP addresses in the range &#8217;192.168.2.0/24&#8217;:

    from netflow, auth where @ip matches '192.168.2.*'

Query only netflow events for IP addresses in the range &#8217;192.168.0.0/16&#8217;:

    from netflow, auth where @ip matches '192.168.*'

Query only netflow events for IP addresses in the range &#8217;192.168.0.0/16&#8217;:

    from netflow, auth where @ip in ('192.168.0.0/16')

Query auth for the user &#8217;bob&#8217;:

    from auth where @user='bob'

Query dnsquery events for the last 30 days:

    from dnsquery earliest=-30d

Query dnsquery events starting from 30 days in the past till 10 days in the past:

    from dnsquery earliest=-30d latest=-10d

Query dnsquery events for the last 2 days starting from the beginning of the day (in this example, 00:00:00 of yesterday):

    from dnsquery earliest=-2d@d

Query dnsquery events starting from the specified date/time until current time:

    from dnsquery earliest='2021-04-01T00:00:00'

Query process events where commandline field contains the phrase &#8217;exe&#8217;:

    from process commandline contains 'exe'

Query process events where commandline field does not contain the phrase &#8217;exe&#8217;:

    from process commandline !contains 'exe'

Query process events where the sensor type field is not equal to &#8217;ENDPOINT_CROWD_STRIKE&#8217;:

    from process sensor_type != 'ENDPOINT_CROWD_STRIKE'

Query process events where commandline field matches a string that is comprised of lowercase characters and numbers followed by a file extension of &#8217;.exe&#8217;:

    from process commandline matches_regex '[a-z0-9]*\.exe'

Query process events where the sensor type is one of &#8217;ENDPOINT_TAEGIS&#8217;, &#8217;ENDPOINT_CROWD_STRIKE&#8217;:

    from process sensor_type IN ('ENDPOINT_TAEGIS','ENDPOINT_CROWD_STRIKE')

Query dnsquery events for domain name ending with &#8217;.google.com&#8217;. It is mandatory to mention field name when using wildcard for equality:

    from dnsquery @domain matches '*.google.com'

Query process events where sensor type equals &#8217;ENDPOINT_CROWD_STRIKE&#8217; and process ID equals &#8217;5201&#8217;. The fields are AND-ed by default if no operator is specified:

    from process where sensor_type='ENDPOINT_CROWD_STRIKE' process_id='5201'

Query process events where sensor_type equals &#8217;ENDPOINT_TAEGIS&#8217; OR process ID equals &#8217;5201&#8217;:

    from process sensor_type='ENDPOINT_TAEGIS' OR process_id='5201'

Query process events for the directory path &#8217;Windows\system32&#8217;:

    from process where image_path contains 'Windows\system32'

Query process events where the value has single quotes that need to be escaped:

    from process where commandline contains e'echo \'mimikatz\''

Query auth events for user accounts being unlocked (Windows Event ID 4767):

    from auth where win_event_id='4767'

Query 10 process events in the last 1 day (24 hours from current time) where sensor_type equals &#8217;ENDPOINT_CROWD_STRIKE&#8217;, sorted by timestamp descending:

    from process sensor_type='ENDPOINT_CROWD_STRIKE' earliest=-1d | head 10

Query 10 process events in the last 1 day (24 hours from current time) where sensor_type equals &#8217;ENDPOINT_TAEGIS&#8217;, sorted by timestamp ascending:

    from process sensor_type='ENDPOINT_TAEGIS' earliest=-1d | tail 10

Query auth events where the target_user_name field is null:

    from auth target_user_name is null

Query auth events where the target_user_name field is not null:

    from auth target_user_name is not null

Query process events that have a newline in the commandline:

    from process where @command contains e'dir\nmkdir test'

#### Search for Generic Events

General search for generic events:

`from`{: .blue } `generic`

![Generic Query](../../img/generic_event_search.gif)

#### Zeek Sensor Generic Event Search

General search for generic events from a specified sensor:

`from`{: .blue } `generic` `where`{: .blue } `sensor_type`{: .gray } `= 'zeek'`

![Generic Zeek Query](../../img/generic_zeek_query.png)

#### Searching Raw Data of Generic Events

This query searches generic events for specified data in a 2 hour window:

`from`{: .blue } `generic` `where`{: .blue } `original_data`{: .gray } `contains 'secureworks' EARLIEST = -2h`

![Searching Raw Data of Generic Events](../../img/generic_query_specified_data.png)

!!! Note

    XDR only stores data that is **not** normalized as generic events. All normalized events still contain the original unaltered message in the `original_data` field. For more information, see [FAQ: Generic Events and Normalized Data](../../generic_normalized_faq.md).